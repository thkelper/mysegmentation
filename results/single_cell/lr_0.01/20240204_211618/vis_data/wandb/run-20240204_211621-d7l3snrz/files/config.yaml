wandb_version: 1

_wandb:
  desc: null
  value:
    python_version: 3.8.0
    cli_version: 0.16.2
    framework: huggingface
    huggingface_version: 4.19.2
    is_jupyter_run: false
    is_kaggle_kernel: true
    start_time: 1707052581.788041
    t:
      1:
      - 1
      - 11
      - 37
      - 41
      - 49
      - 55
      - 60
      - 82
      - 105
      2:
      - 1
      - 5
      - 11
      - 37
      - 41
      - 49
      - 53
      - 55
      - 60
      - 63
      - 80
      - 82
      - 105
      3:
      - 2
      - 23
      4: 3.8.0
      5: 0.16.2
      6: 4.19.2
      8:
      - 2
      - 5
      13: linux-x86_64
lr:
  desc: null
  value: 0.01
crop_size:
  desc: null
  value:
  - 512
  - 512
num_classes:
  desc: null
  value: 2
out_channels:
  desc: null
  value: 1
use_sigmoid:
  desc: null
  value: true
work_dir:
  desc: null
  value: ./results/single_cell/lr_0.01
dataset_type:
  desc: null
  value: CollagenSegDataset
data_root:
  desc: null
  value: /home/yangchangpeng/wing_studio/data/
batch_size:
  desc: null
  value: 8
num_workers:
  desc: null
  value: 4
img_suffix:
  desc: null
  value: .tif
seg_map_suffix:
  desc: null
  value: .png
img_scale:
  desc: null
  value:
  - 512
  - 512
train_pipeline:
  desc: null
  value:
  - type: LoadImageFromFile
  - type: LoadAnnotations
  - type: Resize
    scale:
    - 512
    - 512
    keep_ratio: false
  - type: RandomFlip
    prob: 0.5
  - type: PhotoMetricDistortion
  - type: PackSegInputs
test_pipeline:
  desc: null
  value:
  - type: LoadImageFromFile
  - type: Resize
    scale:
    - 512
    - 512
    keep_ratio: false
  - type: LoadAnnotations
  - type: PackSegInputs
train_dataloader:
  desc: null
  value:
    batch_size: 8
    num_workers: 4
    persistent_workers: true
    sampler:
      type: InfiniteSampler
      shuffle: true
    dataset:
      type: CollagenSegDataset
      img_suffix: .tif
      seg_map_suffix: .png
      data_root: /home/yangchangpeng/wing_studio/data/
      ann_file: 20240201_ASMC_single_cell/train.txt
      data_prefix:
        img_path: 20240201_ASMC_single_cell/
        seg_map_path: 20240201_ASMC_single_cell/
      pipeline:
      - type: LoadImageFromFile
      - type: LoadAnnotations
      - type: Resize
        scale:
        - 512
        - 512
        keep_ratio: false
      - type: RandomFlip
        prob: 0.5
      - type: PhotoMetricDistortion
      - type: PackSegInputs
val_dataloader:
  desc: null
  value:
    batch_size: 8
    num_workers: 4
    persistent_workers: true
    sampler:
      type: DefaultSampler
      shuffle: false
    dataset:
      type: CollagenSegDataset
      img_suffix: .tif
      seg_map_suffix: .png
      data_root: /home/yangchangpeng/wing_studio/data/
      ann_file: 20240201_ASMC_single_cell/val.txt
      data_prefix:
        img_path: 20240201_ASMC_single_cell/
        seg_map_path: 20240201_ASMC_single_cell/
      pipeline:
      - type: LoadImageFromFile
      - type: Resize
        scale:
        - 512
        - 512
        keep_ratio: false
      - type: LoadAnnotations
      - type: PackSegInputs
test_dataloader:
  desc: null
  value:
    batch_size: 8
    num_workers: 4
    persistent_workers: true
    sampler:
      type: DefaultSampler
      shuffle: false
    dataset:
      type: CollagenSegDataset
      img_suffix: .tif
      seg_map_suffix: .png
      data_root: /home/yangchangpeng/wing_studio/data/
      ann_file: 20240201_ASMC_single_cell/val.txt
      data_prefix:
        img_path: 20240201_ASMC_single_cell/
        seg_map_path: 20240201_ASMC_single_cell/
      pipeline:
      - type: LoadImageFromFile
      - type: Resize
        scale:
        - 512
        - 512
        keep_ratio: false
      - type: LoadAnnotations
      - type: PackSegInputs
val_evaluator:
  desc: null
  value:
    type: IoUMetric
    iou_metrics:
    - mIoU
    - mDice
test_evaluator:
  desc: null
  value:
    type: IoUMetric
    iou_metrics:
    - mIoU
    - mDice
norm_cfg:
  desc: null
  value:
    type: SyncBN
    requires_grad: true
data_preprocessor:
  desc: null
  value:
    type: SegDataPreProcessor
    size:
    - 512
    - 512
    mean:
    - 123.675
    - 116.28
    - 103.53
    std:
    - 58.395
    - 57.12
    - 57.375
    bgr_to_rgb: true
    pad_val: 0
    seg_pad_val: 255
model:
  desc: null
  value:
    type: EncoderDecoder
    data_preprocessor:
      type: SegDataPreProcessor
      size:
      - 512
      - 512
      mean:
      - 123.675
      - 116.28
      - 103.53
      std:
      - 58.395
      - 57.12
      - 57.375
      bgr_to_rgb: true
      pad_val: 0
      seg_pad_val: 255
    pretrained: open-mmlab://resnet50_v1c
    backbone:
      type: ResNetV1c
      depth: 50
      num_stages: 4
      out_indices:
      - 0
      - 1
      - 2
      - 3
      dilations:
      - 1
      - 1
      - 2
      - 4
      strides:
      - 1
      - 2
      - 1
      - 1
      norm_cfg:
        type: SyncBN
        requires_grad: true
      norm_eval: false
      style: pytorch
      contract_dilation: true
    decode_head:
      type: PSAHead
      in_channels: 2048
      in_index: 3
      channels: 512
      mask_size:
      - 97
      - 97
      psa_type: bi-direction
      compact: false
      shrink_factor: 2
      normalization_factor: 1.0
      psa_softmax: true
      dropout_ratio: 0.1
      num_classes: 2
      out_channels: 1
      norm_cfg:
        type: SyncBN
        requires_grad: true
      align_corners: false
      loss_decode:
        type: CrossEntropyLoss
        use_sigmoid: true
        loss_weight: 1.0
    auxiliary_head:
      type: FCNHead
      in_channels: 1024
      in_index: 2
      channels: 256
      num_convs: 1
      concat_input: false
      dropout_ratio: 0.1
      num_classes: 2
      out_channels: 1
      norm_cfg:
        type: SyncBN
        requires_grad: true
      align_corners: false
      loss_decode:
        type: CrossEntropyLoss
        use_sigmoid: true
        loss_weight: 0.4
    train_cfg: {}
    test_cfg:
      mode: whole
optimizer:
  desc: null
  value:
    type: SGD
    lr: 0.01
    momentum: 0.9
    weight_decay: 0.0005
optim_wrapper:
  desc: null
  value:
    type: OptimWrapper
    optimizer:
      type: SGD
      lr: 0.01
      momentum: 0.9
      weight_decay: 0.0005
    clip_grad: null
param_scheduler:
  desc: null
  value:
  - type: PolyLR
    eta_min: 0.0001
    power: 0.9
    begin: 0
    end: 6380
    by_epoch: false
train_cfg:
  desc: null
  value:
    type: IterBasedTrainLoop
    max_iters: 6380
    val_interval: 638
val_cfg:
  desc: null
  value:
    type: ValLoop
test_cfg:
  desc: null
  value:
    type: TestLoop
default_hooks:
  desc: null
  value:
    timer:
      type: IterTimerHook
    logger:
      type: LoggerHook
      interval: 638
      log_metric_by_epoch: false
    param_scheduler:
      type: ParamSchedulerHook
    checkpoint:
      type: CheckpointHook
      by_epoch: false
      interval: 638
      save_best: mIoU
    sampler_seed:
      type: DistSamplerSeedHook
    visualization:
      type: SegVisualizationHook
default_scope:
  desc: null
  value: mmseg
env_cfg:
  desc: null
  value:
    cudnn_benchmark: true
    mp_cfg:
      mp_start_method: fork
      opencv_num_threads: 0
    dist_cfg:
      backend: nccl
vis_backends:
  desc: null
  value:
  - type: LocalVisBackend
  - type: TensorboardVisBackend
  - type: WandbVisBackend
visualizer:
  desc: null
  value:
    type: SegLocalVisualizer
    vis_backends:
    - type: LocalVisBackend
    - type: TensorboardVisBackend
    - type: WandbVisBackend
    name: visualizer
log_processor:
  desc: null
  value:
    by_epoch: false
log_level:
  desc: null
  value: INFO
load_from:
  desc: null
  value: null
resume:
  desc: null
  value: false
tta_model:
  desc: null
  value:
    type: SegTTAModel
launcher:
  desc: null
  value: none
