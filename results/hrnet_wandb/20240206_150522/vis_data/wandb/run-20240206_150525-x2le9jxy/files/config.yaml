wandb_version: 1

_wandb:
  desc: null
  value:
    python_version: 3.8.0
    cli_version: 0.16.2
    framework: huggingface
    huggingface_version: 4.19.2
    is_jupyter_run: false
    is_kaggle_kernel: true
    start_time: 1707203125.89615
    t:
      1:
      - 1
      - 11
      - 37
      - 41
      - 49
      - 55
      - 60
      - 82
      - 105
      2:
      - 1
      - 5
      - 11
      - 37
      - 41
      - 49
      - 53
      - 55
      - 60
      - 63
      - 80
      - 82
      - 105
      3:
      - 2
      - 23
      4: 3.8.0
      5: 0.16.2
      6: 4.19.2
      8:
      - 2
      - 5
      13: linux-x86_64
norm_cfg:
  desc: null
  value:
    type: SyncBN
    requires_grad: true
data_preprocessor:
  desc: null
  value:
    type: SegDataPreProcessor
    mean:
    - 123.675
    - 116.28
    - 103.53
    std:
    - 58.395
    - 57.12
    - 57.375
    bgr_to_rgb: true
    pad_val: 0
    seg_pad_val: 255
    size:
    - 512
    - 1024
model:
  desc: null
  value:
    type: EncoderDecoder
    data_preprocessor:
      type: SegDataPreProcessor
      mean:
      - 123.675
      - 116.28
      - 103.53
      std:
      - 58.395
      - 57.12
      - 57.375
      bgr_to_rgb: true
      pad_val: 0
      seg_pad_val: 255
      size:
      - 512
      - 1024
    pretrained: open-mmlab://msra/hrnetv2_w18
    backbone:
      type: HRNet
      norm_cfg:
        type: SyncBN
        requires_grad: true
      norm_eval: false
      extra:
        stage1:
          num_modules: 1
          num_branches: 1
          block: BOTTLENECK
          num_blocks:
          - 4
          num_channels:
          - 64
        stage2:
          num_modules: 1
          num_branches: 2
          block: BASIC
          num_blocks:
          - 4
          - 4
          num_channels:
          - 18
          - 36
        stage3:
          num_modules: 4
          num_branches: 3
          block: BASIC
          num_blocks:
          - 4
          - 4
          - 4
          num_channels:
          - 18
          - 36
          - 72
        stage4:
          num_modules: 3
          num_branches: 4
          block: BASIC
          num_blocks:
          - 4
          - 4
          - 4
          - 4
          num_channels:
          - 18
          - 36
          - 72
          - 144
    decode_head:
      type: FCNHead
      in_channels:
      - 18
      - 36
      - 72
      - 144
      in_index:
      - 0
      - 1
      - 2
      - 3
      channels: 270
      input_transform: resize_concat
      kernel_size: 1
      num_convs: 1
      concat_input: false
      dropout_ratio: -1
      num_classes: 2
      norm_cfg:
        type: SyncBN
        requires_grad: true
      align_corners: false
      loss_decode:
        type: CrossEntropyLoss
        use_sigmoid: true
        loss_weight: 1.0
      out_channels: 1
    train_cfg: {}
    test_cfg:
      mode: whole
dataset_type:
  desc: null
  value: CollagenSegDataset
data_root:
  desc: null
  value: /home/yangchangpeng/wing_studio/data/collagen_data/col_train_dataset/
img_scale:
  desc: null
  value:
  - 512
  - 512
train_pipeline:
  desc: null
  value:
  - type: LoadImageFromFile
  - type: LoadAnnotations
  - type: Resize
    scale:
    - 512
    - 512
    keep_ratio: false
  - type: RandomFlip
    prob: 0.5
  - type: PhotoMetricDistortion
  - type: PackSegInputs
test_pipeline:
  desc: null
  value:
  - type: LoadImageFromFile
  - type: Resize
    scale:
    - 512
    - 512
    keep_ratio: false
  - type: LoadAnnotations
  - type: PackSegInputs
train_dataloader:
  desc: null
  value:
    batch_size: 4
    num_workers: 1
    persistent_workers: true
    sampler:
      type: InfiniteSampler
      shuffle: true
    dataset:
      type: CollagenSegDataset
      seg_map_suffix: .png
      data_root: /home/yangchangpeng/wing_studio/data/collagen_data/col_train_dataset/
      ann_file: train.txt
      data_prefix:
        img_path: img_dir/train/
        seg_map_path: ann_dir/train/
      pipeline:
      - type: LoadImageFromFile
      - type: LoadAnnotations
      - type: Resize
        scale:
        - 512
        - 512
        keep_ratio: false
      - type: RandomFlip
        prob: 0.5
      - type: PhotoMetricDistortion
      - type: PackSegInputs
val_dataloader:
  desc: null
  value:
    batch_size: 1
    num_workers: 1
    persistent_workers: true
    sampler:
      type: DefaultSampler
      shuffle: false
    dataset:
      type: CollagenSegDataset
      seg_map_suffix: .png
      data_root: /home/yangchangpeng/wing_studio/data/collagen_data/col_train_dataset/
      ann_file: val.txt
      data_prefix:
        img_path: img_dir/val
        seg_map_path: ann_dir/val
      pipeline:
      - type: LoadImageFromFile
      - type: Resize
        scale:
        - 512
        - 512
        keep_ratio: false
      - type: LoadAnnotations
      - type: PackSegInputs
test_dataloader:
  desc: null
  value:
    batch_size: 1
    num_workers: 1
    persistent_workers: true
    sampler:
      type: DefaultSampler
      shuffle: false
    dataset:
      type: CollagenSegDataset
      seg_map_suffix: .png
      data_root: /home/yangchangpeng/wing_studio/data/collagen_data/col_train_dataset/
      ann_file: val.txt
      data_prefix:
        img_path: img_dir/val
        seg_map_path: ann_dir/val
      pipeline:
      - type: LoadImageFromFile
      - type: Resize
        scale:
        - 512
        - 512
        keep_ratio: false
      - type: LoadAnnotations
      - type: PackSegInputs
val_evaluator:
  desc: null
  value:
    type: IoUMetric
    iou_metrics:
    - mIoU
    - mDice
test_evaluator:
  desc: null
  value:
    type: IoUMetric
    iou_metrics:
    - mIoU
    - mDice
default_scope:
  desc: null
  value: mmseg
env_cfg:
  desc: null
  value:
    cudnn_benchmark: true
    mp_cfg:
      mp_start_method: fork
      opencv_num_threads: 0
    dist_cfg:
      backend: nccl
vis_backends:
  desc: null
  value:
  - type: LocalVisBackend
  - type: TensorboardVisBackend
  - type: WandbVisBackend
visualizer:
  desc: null
  value:
    type: SegLocalVisualizer
    vis_backends:
    - type: LocalVisBackend
    - type: TensorboardVisBackend
    - type: WandbVisBackend
    name: visualizer
log_processor:
  desc: null
  value:
    by_epoch: false
log_level:
  desc: null
  value: INFO
load_from:
  desc: null
  value: null
resume:
  desc: null
  value: false
tta_model:
  desc: null
  value:
    type: SegTTAModel
optimizer:
  desc: null
  value:
    type: SGD
    lr: 0.01
    momentum: 0.9
    weight_decay: 0.0005
optim_wrapper:
  desc: null
  value:
    type: OptimWrapper
    optimizer:
      type: SGD
      lr: 0.01
      momentum: 0.9
      weight_decay: 0.0005
    clip_grad: null
param_scheduler:
  desc: null
  value:
  - type: PolyLR
    eta_min: 0.0001
    power: 0.9
    begin: 0
    end: 6380
    by_epoch: false
train_cfg:
  desc: null
  value:
    type: IterBasedTrainLoop
    max_iters: 6380
    val_interval: 638
val_cfg:
  desc: null
  value:
    type: ValLoop
test_cfg:
  desc: null
  value:
    type: TestLoop
default_hooks:
  desc: null
  value:
    timer:
      type: IterTimerHook
    logger:
      type: LoggerHook
      interval: 638
      log_metric_by_epoch: false
    param_scheduler:
      type: ParamSchedulerHook
    checkpoint:
      type: CheckpointHook
      by_epoch: false
      interval: 638
      save_best: mIoU
    sampler_seed:
      type: DistSamplerSeedHook
    visualization:
      type: SegVisualizationHook
crop_size:
  desc: null
  value:
  - 512
  - 1024
num_classes:
  desc: null
  value: 2
out_channels:
  desc: null
  value: 1
use_sigmoid:
  desc: null
  value: true
work_dir:
  desc: null
  value: ./results/hrnet_wandb
launcher:
  desc: null
  value: none
